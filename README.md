# ILINE-Group
Тестовое задание

## Задача:
Написать скрипт, который позволит определенные логи событий из срм системы "amo crm" загружать в гугл таблицу, а именно в динамические ячейки гугл таблиц.
Например, Логи кластера №1 сегодня в ячейку А1, а завтра Логи этого же кластера отправляем в ячейку А2 и тд.

## Вариант решения:

Для подключения к гугл-таблицам, создания новой таблицы и её наполнения использован Google Sheets API v4.

В Google Cluod был создан проект, подключены для этого проекта API: Drive API и Sheets API.

В проекте был создан сервисный аккаунт и для него был добавлен ключ (тип ключа JSON).

JSON файл (скачен при создании ключа и хранится в папке с кодом), который необходим для создания сервис-объекта для работы с гугл таблицами.
(Service Accounts - Manage keys - Add key - JSON).

## Requirements
google-api-python-client

python-dotenv

## main.py 
1. Класс Tables, имеет метод создания новой гугл-таблицы, метод записи данных в таблицу из файла, метод получения URL таблицы.
2. Имя файла (либо путь/имя) с логами необходимо указать в файле .env в переменной LOG_FILE.
3. При выполнении main.py будет предложено создать новую таблицу, если необходимо.
Если новая таблица не создана, данные будут записаны в существующую таблицу, ID которой можно указать в переменной окружения (SPREADSHEET_ID).
4. Внутри класса Tables создан сервис-объект для подключения и работы с гугл-таблицами и предоставления доступа к ним (в случае создания новой таблицы).
5. Для создания подключения, в переменной окружения CREDENTIALS_FILE необходимо указать имя JSON файла,
скаченного при создании ключа сервисного аккаунта.
6. Добавление данных будет осуществлять последовательно с ячейки А1,
при каждом выполнении main.py данные будут записываться в следующую
пустую ячейку (А2, А3 и тд.).


## .env
Пример содержимого файла

CREDENTIALS_FILE = 'managesheet-371909-eeba38bd209f.json' # пример имени файла с закрытым ключом, полученый при создании Сервисного аккаунта


SPREADSHEET_ID = '1hrFK9q3kxBjY20KjhKqLgRw8tOLJEZDSZYPQH4hOX8g'  # пример ID google таблицы, куда вносим данные


LOG_FILE = logs.log  # путь и имя файла с логами
